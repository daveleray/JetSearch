<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- The HTML 4.01 Transitional DOCTYPE declaration-->
<!-- above set at the top of the file will set     -->
<!-- the browser's rendering engine into           -->
<!-- "Quirks Mode". Replacing this declaration     -->
<!-- with a "Standards Mode" doctype is supported, -->
<!-- but may lead to some differences in layout.   -->

<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    


<!-- Latest compiled and minified JavaScript -->


<style>
@font-face{font-family:'Glyphicons Halflings';src:url(https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/fonts/glyphicons-halflings-regular.eot);src:url(https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/fonts/glyphicons-halflings-regular.eot?#iefix) format('embedded-opentype'),url(https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/fonts/glyphicons-halflings-regular.woff) format('woff'),url(https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/fonts/glyphicons-halflings-regular.ttf) format('truetype'),url(https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/fonts/glyphicons-halflings-regular.svg#glyphicons_halflingsregular) format('svg')}.glyphicon{position:relative;top:1px;display:inline-block;font-family:'Glyphicons Halflings';font-style:normal;font-weight:400;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.glyphicon-asterisk:before{content:"\2a"}.glyphicon-plus:before{content:"\2b"}.glyphicon-euro:before{content:"\20ac"}.glyphicon-minus:before{content:"\2212"}.glyphicon-cloud:before{content:"\2601"}.glyphicon-envelope:before{content:"\2709"}.glyphicon-pencil:before{content:"\270f"}.glyphicon-glass:before{content:"\e001"}.glyphicon-music:before{content:"\e002"}.glyphicon-search:before{content:"\e003"}.glyphicon-heart:before{content:"\e005"}.glyphicon-star:before{content:"\e006"}.glyphicon-star-empty:before{content:"\e007"}.glyphicon-user:before{content:"\e008"}.glyphicon-film:before{content:"\e009"}.glyphicon-th-large:before{content:"\e010"}.glyphicon-th:before{content:"\e011"}.glyphicon-th-list:before{content:"\e012"}.glyphicon-ok:before{content:"\e013"}.glyphicon-remove:before{content:"\e014"}.glyphicon-zoom-in:before{content:"\e015"}.glyphicon-zoom-out:before{content:"\e016"}.glyphicon-off:before{content:"\e017"}.glyphicon-signal:before{content:"\e018"}.glyphicon-cog:before{content:"\e019"}.glyphicon-trash:before{content:"\e020"}.glyphicon-home:before{content:"\e021"}.glyphicon-file:before{content:"\e022"}.glyphicon-time:before{content:"\e023"}.glyphicon-road:before{content:"\e024"}.glyphicon-download-alt:before{content:"\e025"}.glyphicon-download:before{content:"\e026"}.glyphicon-upload:before{content:"\e027"}.glyphicon-inbox:before{content:"\e028"}.glyphicon-play-circle:before{content:"\e029"}.glyphicon-repeat:before{content:"\e030"}.glyphicon-refresh:before{content:"\e031"}.glyphicon-list-alt:before{content:"\e032"}.glyphicon-lock:before{content:"\e033"}.glyphicon-flag:before{content:"\e034"}.glyphicon-headphones:before{content:"\e035"}.glyphicon-volume-off:before{content:"\e036"}.glyphicon-volume-down:before{content:"\e037"}.glyphicon-volume-up:before{content:"\e038"}.glyphicon-qrcode:before{content:"\e039"}.glyphicon-barcode:before{content:"\e040"}.glyphicon-tag:before{content:"\e041"}.glyphicon-tags:before{content:"\e042"}.glyphicon-book:before{content:"\e043"}.glyphicon-bookmark:before{content:"\e044"}.glyphicon-print:before{content:"\e045"}.glyphicon-camera:before{content:"\e046"}.glyphicon-font:before{content:"\e047"}.glyphicon-bold:before{content:"\e048"}.glyphicon-italic:before{content:"\e049"}.glyphicon-text-height:before{content:"\e050"}.glyphicon-text-width:before{content:"\e051"}.glyphicon-align-left:before{content:"\e052"}.glyphicon-align-center:before{content:"\e053"}.glyphicon-align-right:before{content:"\e054"}.glyphicon-align-justify:before{content:"\e055"}.glyphicon-list:before{content:"\e056"}.glyphicon-indent-left:before{content:"\e057"}.glyphicon-indent-right:before{content:"\e058"}.glyphicon-facetime-video:before{content:"\e059"}.glyphicon-picture:before{content:"\e060"}.glyphicon-map-marker:before{content:"\e062"}.glyphicon-adjust:before{content:"\e063"}.glyphicon-tint:before{content:"\e064"}.glyphicon-edit:before{content:"\e065"}.glyphicon-share:before{content:"\e066"}.glyphicon-check:before{content:"\e067"}.glyphicon-move:before{content:"\e068"}.glyphicon-step-backward:before{content:"\e069"}.glyphicon-fast-backward:before{content:"\e070"}.glyphicon-backward:before{content:"\e071"}.glyphicon-play:before{content:"\e072"}.glyphicon-pause:before{content:"\e073"}.glyphicon-stop:before{content:"\e074"}.glyphicon-forward:before{content:"\e075"}.glyphicon-fast-forward:before{content:"\e076"}.glyphicon-step-forward:before{content:"\e077"}.glyphicon-eject:before{content:"\e078"}.glyphicon-chevron-left:before{content:"\e079"}.glyphicon-chevron-right:before{content:"\e080"}.glyphicon-plus-sign:before{content:"\e081"}.glyphicon-minus-sign:before{content:"\e082"}.glyphicon-remove-sign:before{content:"\e083"}.glyphicon-ok-sign:before{content:"\e084"}.glyphicon-question-sign:before{content:"\e085"}.glyphicon-info-sign:before{content:"\e086"}.glyphicon-screenshot:before{content:"\e087"}.glyphicon-remove-circle:before{content:"\e088"}.glyphicon-ok-circle:before{content:"\e089"}.glyphicon-ban-circle:before{content:"\e090"}.glyphicon-arrow-left:before{content:"\e091"}.glyphicon-arrow-right:before{content:"\e092"}.glyphicon-arrow-up:before{content:"\e093"}.glyphicon-arrow-down:before{content:"\e094"}.glyphicon-share-alt:before{content:"\e095"}.glyphicon-resize-full:before{content:"\e096"}.glyphicon-resize-small:before{content:"\e097"}.glyphicon-exclamation-sign:before{content:"\e101"}.glyphicon-gift:before{content:"\e102"}.glyphicon-leaf:before{content:"\e103"}.glyphicon-fire:before{content:"\e104"}.glyphicon-eye-open:before{content:"\e105"}.glyphicon-eye-close:before{content:"\e106"}.glyphicon-warning-sign:before{content:"\e107"}.glyphicon-plane:before{content:"\e108"}.glyphicon-calendar:before{content:"\e109"}.glyphicon-random:before{content:"\e110"}.glyphicon-comment:before{content:"\e111"}.glyphicon-magnet:before{content:"\e112"}.glyphicon-chevron-up:before{content:"\e113"}.glyphicon-chevron-down:before{content:"\e114"}.glyphicon-retweet:before{content:"\e115"}.glyphicon-shopping-cart:before{content:"\e116"}.glyphicon-folder-close:before{content:"\e117"}.glyphicon-folder-open:before{content:"\e118"}.glyphicon-resize-vertical:before{content:"\e119"}.glyphicon-resize-horizontal:before{content:"\e120"}.glyphicon-hdd:before{content:"\e121"}.glyphicon-bullhorn:before{content:"\e122"}.glyphicon-bell:before{content:"\e123"}.glyphicon-certificate:before{content:"\e124"}.glyphicon-thumbs-up:before{content:"\e125"}.glyphicon-thumbs-down:before{content:"\e126"}.glyphicon-hand-right:before{content:"\e127"}.glyphicon-hand-left:before{content:"\e128"}.glyphicon-hand-up:before{content:"\e129"}.glyphicon-hand-down:before{content:"\e130"}.glyphicon-circle-arrow-right:before{content:"\e131"}.glyphicon-circle-arrow-left:before{content:"\e132"}.glyphicon-circle-arrow-up:before{content:"\e133"}.glyphicon-circle-arrow-down:before{content:"\e134"}.glyphicon-globe:before{content:"\e135"}.glyphicon-wrench:before{content:"\e136"}.glyphicon-tasks:before{content:"\e137"}.glyphicon-filter:before{content:"\e138"}.glyphicon-briefcase:before{content:"\e139"}.glyphicon-fullscreen:before{content:"\e140"}.glyphicon-dashboard:before{content:"\e141"}.glyphicon-paperclip:before{content:"\e142"}.glyphicon-heart-empty:before{content:"\e143"}.glyphicon-link:before{content:"\e144"}.glyphicon-phone:before{content:"\e145"}.glyphicon-pushpin:before{content:"\e146"}.glyphicon-usd:before{content:"\e148"}.glyphicon-gbp:before{content:"\e149"}.glyphicon-sort:before{content:"\e150"}.glyphicon-sort-by-alphabet:before{content:"\e151"}.glyphicon-sort-by-alphabet-alt:before{content:"\e152"}.glyphicon-sort-by-order:before{content:"\e153"}.glyphicon-sort-by-order-alt:before{content:"\e154"}.glyphicon-sort-by-attributes:before{content:"\e155"}.glyphicon-sort-by-attributes-alt:before{content:"\e156"}.glyphicon-unchecked:before{content:"\e157"}.glyphicon-expand:before{content:"\e158"}.glyphicon-collapse-down:before{content:"\e159"}.glyphicon-collapse-up:before{content:"\e160"}.glyphicon-log-in:before{content:"\e161"}.glyphicon-flash:before{content:"\e162"}.glyphicon-log-out:before{content:"\e163"}.glyphicon-new-window:before{content:"\e164"}.glyphicon-record:before{content:"\e165"}.glyphicon-save:before{content:"\e166"}.glyphicon-open:before{content:"\e167"}.glyphicon-saved:before{content:"\e168"}.glyphicon-import:before{content:"\e169"}.glyphicon-export:before{content:"\e170"}.glyphicon-send:before{content:"\e171"}.glyphicon-floppy-disk:before{content:"\e172"}.glyphicon-floppy-saved:before{content:"\e173"}.glyphicon-floppy-remove:before{content:"\e174"}.glyphicon-floppy-save:before{content:"\e175"}.glyphicon-floppy-open:before{content:"\e176"}.glyphicon-credit-card:before{content:"\e177"}.glyphicon-transfer:before{content:"\e178"}.glyphicon-cutlery:before{content:"\e179"}.glyphicon-header:before{content:"\e180"}.glyphicon-compressed:before{content:"\e181"}.glyphicon-earphone:before{content:"\e182"}.glyphicon-phone-alt:before{content:"\e183"}.glyphicon-tower:before{content:"\e184"}.glyphicon-stats:before{content:"\e185"}.glyphicon-sd-video:before{content:"\e186"}.glyphicon-hd-video:before{content:"\e187"}.glyphicon-subtitles:before{content:"\e188"}.glyphicon-sound-stereo:before{content:"\e189"}.glyphicon-sound-dolby:before{content:"\e190"}.glyphicon-sound-5-1:before{content:"\e191"}.glyphicon-sound-6-1:before{content:"\e192"}.glyphicon-sound-7-1:before{content:"\e193"}.glyphicon-copyright-mark:before{content:"\e194"}.glyphicon-registration-mark:before{content:"\e195"}.glyphicon-cloud-download:before{content:"\e197"}.glyphicon-cloud-upload:before{content:"\e198"}.glyphicon-tree-conifer:before{content:"\e199"}.glyphicon-tree-deciduous:before{content:"\e200"};
</style>

  <link rel="stylesheet" href="//code.jquery.com/mobile/1.4.3/jquery.mobile-1.4.3.min.css">
   <link rel="stylesheet" href="jqm-icon-pack-fa.css">
   <script src="http://code.jquery.com/jquery-latest.min.js"></script>
   <script type="text/javascript" src="sessvars.js"></script>
  <script src="//code.jquery.com/mobile/1.4.3/jquery.mobile-1.4.3.min.js"></script>
<link rel="stylesheet" href="dist/themes/default/style.min.css" />
<script src="dist/jstree.min.js"></script>


<style>
#wrap {
    width: 600px;
    height: 200px;
    overflow: auto;
     border-style: dotted;
    border-width: 1px;
    float: left;
    margin:5px;
    
}

#foldersection{
height: 220px;
}
</style>
    
<script>




function recalculateFolders()
{
	$("#folders").empty();
	$("#folderid").empty();
	$("#parent_folderid").empty();
	$.get('folders', function( data ) {				
		
			
		addTheFolderOptions(data,"folderid");
		addTheFolderOptions(data,"parent_folderid");
		 
		  $('#jstree_demo_div').jstree("destroy");

		  $('#jstree_demo_div').jstree({ 'core' : {
			    'check_callback' : true,
		        'data' : data
		        }
		    });
		  
		 $('#jstree_demo_div').on('loaded.jstree', function(e,data) {

			 var depth = 4;
			    data.instance.get_container().find('li').each(function (i) {
			        if (data.instance.get_path($(this)).length <= depth) {
			            data.instance.open_node($(this));
			        }
			    });
		  });
		  
		 $('#jstree_demo_div')
		  // listen for event
		  .on('select_node.jstree', function (e, data) {
			    //selected node object: data.inst.get_json()[0];
	            //selected node text: data.inst.get_json()[0].data
	            if(!data.node.original.isFolder)
	            	{
	               	    var targetURL='index.html?folder='+data.selected[0];
		            	window.location=targetURL;
	            	}
	            else
	            	{
	            		if(data.node.state.opened)
	            			{
	            				data.instance.close_node(data.node);
	            			}
	            		else
	            			{
	            				data.instance.open_node(data.node);
	            			}
	            	 
	            	
	            	}
	       
		  })
	});


}

function addTheFolderOptions(data,divid)
{
	 for(var j=0;j<data.simpleFolderDisplay.length;j++)
	 {
	 	var o = new Option(data.simpleFolderDisplay[j], data.simpleFolderIDs[j]);
		/// jquerify the DOM object 'o' so we can use the html method
		$(o).html(data.simpleFolderDisplay[j]);
		$("#"+divid).append(o);
	 }
}

  //setup folders
  $(document).on('pagecreate',function(event){
  
	  if(window.pageinit)
		 {
		  return;
		 }
	  

	  $("#submitformbutton").click(function(event2){  
		 	 event2.stopPropagation();
		
		    $.post("batches",
				    {
		    		  batchname:$('#batchname').val(),
				      folderid:$('#folderid').val(),
				      docids:$('#docids').val()
				    },function(data)
				    {
				    	recalculateFolders();
				    	$( ":mobile-pagecontainer" ).pagecontainer( "change", "#folderspage");
				    });
			  });
		 //submitformbutton
	  
		 
		 //submitformbutton_folder
	  $("#submitformbutton_folder").click(function(event2){  
		 	 event2.stopPropagation();

				
				
// 				String parentFolder =req.getParameter("parent_folderid");
// 				String folderName=req.getParameter("foldername");
		    $.post("folders",
				    {
		    		  foldername:$('#foldername').val(),
		    		  parent_folderid:$('#parent_folderid').val()
				    },function(data)
				    {
				    	recalculateFolders();
				    	$( ":mobile-pagecontainer" ).pagecontainer( "change", "#folderspage");
				    });
		    
		    
  
		});
		 //submitformbutton		 
		 
	  	///added new function
		$.get( "getlo", function( data ) {
			var tmpObj = data.URL
			if(!data.USER)
				{
					window.location=data.URL;
				}
			if(window.pageinit)
				{
				
				}
			else
				{					
							recalculateFolders();
							window.pageinit=true;
				}
 
			});

		});
</script>



    <title>CloudReviewer</title>
  </head>

  <body>
        <div data-role="page" id="folderspage">
 
        <div data-role="header" data-id="foo1" data-position="fixed">
            		<h1>CloudReviewer</h1>
		
				 <div class="ui-btn-right" data-role="controlgroup" data-type="horizontal">
	    <a data-ajax="false" href="highlights.html" data-role="button" data-icon="pencil" >Highlighting</a>
	    <a data-ajax="false" href="panels.html" data-role="button" data-icon="list" >Panels</a>
		<a data-ajax="false" data-role="button" data-icon="book" href="index.html" >Review</a>
		<a data-ajax="false" data-role="button" class="ui-btn-active " data-icon="folder" href="folders.html" >Folders</a>
		</div>
        </div><!-- /header -->
    
    
        <div data-role="content">
    
    <div id="foldersection">
    
    
    <div id="wrap">
   
    <div id="jstree_demo_div">
    
	
    
    </div>
    
	 </div>	    
	<a href="#newfolder" data-role="button" data-inline="true" style="margin-top:4px" data-transition="pop">Add New Empty Folder</a>
	</div>
	
	<hr>
	<div>
	<center><h3>Create new Batches</h3></center>
	<a href="#popup" data-role="button" data-inline="true" data-transition="pop">Add new Batch by Doc IDs</a>
	</div>
	
        </div><!-- /content -->
 
 
 
        <div data-role="footer" data-position="fixed">
            <h4>&copy David LeRay 2014</h4>
        </div><!-- /footer -->
 
    </div><!-- /page -->
    
    
    
    <!-- Start of second page: #popup -->
<div data-role="page" id="popup">

	<div data-role="header" data-theme="e">
		<h1>New Batch</h1>
	</div><!-- /header -->

	<div data-role="content" data-theme="d">	
		<form id="addbatchform" > 
				
			<div data-role="fieldcontain">
	         <label for="batchname">Batch Name:</label>
	         <input type="text" name="batchname" id="batchname" value="MyBatch"  />
			</div>
			
			<div data-role="fieldcontain">
			<label for="docids">Document IDs:</label>
			<textarea data-role="none" cols="40" rows="15" name="docids" id="docids"></textarea>
			</div>
			
			<div data-role="fieldcontain">
				<label for="folderid" class="select">Choose folder:</label>
				<select name="folderid" id="folderid">
				</select>
			</div>
	
		 </form>
			<button id="submitformbutton" data-theme="b" name="submit" value="submit-value">Submit</button>		
		
		<p><a href="#one" data-rel="back" data-role="button" data-inline="true" data-icon="back">Cancel</a></p>	
	</div><!-- /content -->
	
	<div data-role="footer">
		  <h4>&copy David LeRay 2014</h4>
	</div><!-- /footer -->
</div><!-- /page popup -->

       <!-- Start of third page: #popup -->
<div data-role="page" id="newfolder">

	<div data-role="header" data-theme="e">
		<h1>New Folder</h1>
	</div><!-- /header -->

	<div data-role="content" data-theme="d">	
		<form id="addfolderform" > 
				
			<div data-role="fieldcontain">
	         <label for="foldername">Folder Name:</label>
	         <input type="text" name="foldername" id="foldername" value="MyFolder"  />
			</div>
			
			<div data-role="fieldcontain">
				<label for="parent_folderid" class="select">Choose Parent Folder:</label>
				<select name="parent_folderid" id="parent_folderid">
				</select>
			</div>
	
		 </form>
			<button id="submitformbutton_folder" data-theme="b" name="submit" value="submit-value">Add Folder</button>		
		
		<p><a href="#one" data-rel="back" data-role="button" data-inline="true" data-icon="back">Cancel</a></p>	
	</div><!-- /content -->
	
	<div data-role="footer">
		  <h4>&copy David LeRay 2014</h4>
	</div><!-- /footer -->
</div><!-- /page popup -->
   
   
    
  </body>
</html>



